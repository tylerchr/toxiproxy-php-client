language: php

php:
- 5.4
- 5.5
- 5.6
- 7.0
- hhvm

matrix:
  allow_failures:
  - php: hhvm

before_install:
- wget -O toxiproxy_2.0.0_amd64.deb https://github.com/Shopify/toxiproxy/releases/download/v2.0.0/toxiproxy_2.0.0_amd64.deb
- sudo dpkg -i ./toxiproxy_*_amd64.deb
- rm toxiproxy_*_amd64.deb
- sudo service toxiproxy start
before_script:
- composer self-update
- composer install --prefer-source --no-interaction --dev

script: phpunit ./tests

branches:
  only:
  - master